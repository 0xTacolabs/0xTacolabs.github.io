<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Mordor Ransomware Dropper - Obfuscated Javascript with Hidden Payloads" /><meta property="og:locale" content="en" /><meta name="description" content="Javascript Malware Dropper that retrieves and executes a Mordor Ransomware payload. Utilises a few basic anti-automation techniques." /><meta property="og:description" content="Javascript Malware Dropper that retrieves and executes a Mordor Ransomware payload. Utilises a few basic anti-automation techniques." /><link rel="canonical" href="https://0xtacolabs.github.io/posts/Mordor-Dropper/" /><meta property="og:url" content="https://0xtacolabs.github.io/posts/Mordor-Dropper/" /><meta property="og:site_name" content="0xtacolabs" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-12-27T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Mordor Ransomware Dropper - Obfuscated Javascript with Hidden Payloads" /><meta name="twitter:site" content="@0xtacolabs" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2020-12-27T00:00:00+00:00","datePublished":"2020-12-27T00:00:00+00:00","description":"Javascript Malware Dropper that retrieves and executes a Mordor Ransomware payload. Utilises a few basic anti-automation techniques.","headline":"Mordor Ransomware Dropper - Obfuscated Javascript with Hidden Payloads","mainEntityOfPage":{"@type":"WebPage","@id":"https://0xtacolabs.github.io/posts/Mordor-Dropper/"},"url":"https://0xtacolabs.github.io/posts/Mordor-Dropper/"}</script><title>Mordor Ransomware Dropper - Obfuscated Javascript with Hidden Payloads | 0xtacolabs</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="0xtacolabs"><meta name="application-name" content="0xtacolabs"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> </a></div><div class="site-title mt-3"> <a href="/">0xtacolabs</a></div><div class="site-subtitle font-italic">A malware analysis blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/0xtacolabs" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/0xtacolabs" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['0xtacolabs','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Mordor Ransomware Dropper - Obfuscated Javascript with Hidden Payloads</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Mordor Ransomware Dropper - Obfuscated Javascript with Hidden Payloads</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1609027200" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Dec 27, 2020 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/0xtacolabs">your_full_name</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="926 words"> <em>5 min</em> read</span></div></div></div><div class="post-content"><p>Javascript Malware Dropper that retrieves and executes a Mordor Ransomware payload. Utilises a few basic anti-automation techniques.</p><h1 id="mordor-ransomware-dropper-with-multiple-layers-on-encoding">Mordor Ransomware Dropper with Multiple Layers on Encoding</h1><h1 id="summary">Summary</h1><p>The sample is a piece of obfuscated javascript code that retrieves and launches/executes a malicious executable from an attacker controlled server. The code utilises a few simple anti-sandbox techniques, and is well obfuscated in that all malicious commands are not visible in the initial code, and require successful reverse-engineering of the decoding routine in order to analyse.</p><p>Based on the below article and analysis of the attacker controlled domain, the file was likely used to retrieve Mordor Ransomware.</p><p>https://www.malware-traffic-analysis.net/2017/05/02/index.html</p><h1 id="indicators-of-compromise-iocs">Indicators of Compromise IOC’s</h1><div class="table-wrapper"><table><thead><tr><th>IOC<th>Severity<tbody><tr><td>kingzoneg[.]top/admin.php?f=404<td>High<tr><td>%TEMPLATES%\d{4,6}.exe$<td>High<tr><td>kingzoneg[.]top/admin.php<td>High<tr><td>kingzoneg[.]top<td>Medium<tr><td>47.91[.]93.208<td>Medium<tr><td>47.91[.]93.208/admin.php<td>High</table></div><h2 id="source-file"><span class="mr-2">Source File</span><a href="#source-file" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The javascript file is from the HynekPetrak Javascript Malware Collection.</p><p>https://github.com/HynekPetrak/javascript-malware-collection/blob/master/2017/20170501/20170501_018edd4b581516682574e305c835c5c9.js</p><p><img data-src="/resources/Images/2020-12-27/image-20201226172020876.png" alt="image-20201226172020876" data-proofer-ignore></p><h2 id="analysis"><span class="mr-2">Analysis</span><a href="#analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The code starts with a few variables created by concatenating/combining lots of small strings. This makes the code slightly more difficult to read, but is trivial to fix and remove.</p><p><img data-src="/resources/Images/2020-12-27/image-20201226174008720.png" alt="image-20201226174008720" data-proofer-ignore></p><p>There is a small function that appears to be a simple decoding routine. Although it breaks up the string into an array before rejoining, the code is essentially a search and replace.</p><p><img data-src="/resources/Images/2020-12-27/image-20201226172748281.png" alt="image-20201226172748281" data-proofer-ignore></p><p>There are a few variables where the results of the decoded strings are stored, and some variables that store the results of those decoded strings being executed via eval.</p><p><img data-src="/resources/Images/2020-12-27/image-20201226173054150.png" alt="image-20201226173054150" data-proofer-ignore></p><p>The code finishes with two eval statements, both on the results of decoded strings. Interestingly, the second eval performs the decoding twice, and also performs a check against a value not present in the initial code. Likely, this checked value is defined in one of the obfuscated strings and eval statements.</p><p><img data-src="/resources/Images/2020-12-27/image-20201226173642051.png" alt="image-20201226173642051" data-proofer-ignore></p><h2 id="reverse-engineering"><span class="mr-2">Reverse Engineering</span><a href="#reverse-engineering" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Now that there’s a general understanding of the malware structure, the code can be analysed and decoded using cyberchef.</p><p>First job is to fix up the “broken” strings, this can easily be done using find/replace and regex.</p><ul><li>\+? looks for plus signs at the beginning or end of the line<li>[”’] Looks for starting and ending quotes<li>\+\n looks for a plus sign followed by a newline<li>\+?</ul><p><img data-src="/resources/Images/2020-12-27/image-20201226185915303.png" alt="image-20201226185915303" data-proofer-ignore></p><p>Which can now be copy/pasted into vscode in a much more readable format.</p><p>(Note that you can ctrl+shift+p, change language mode, javascript - to enable highlighting without saving as a file</p><p><img data-src="/resources/Images/2020-12-27/image-20201226190020160.png" alt="image-20201226190020160" data-proofer-ignore></p><p>Now it’s time to rename some functions and variable names, anything that makes sense will do.</p><p><img data-src="/resources/Images/2020-12-27/image-20201226190649713.png" alt="image-20201226190649713" data-proofer-ignore></p><p>The results *could* look like this.</p><p><img data-src="/resources/Images/2020-12-27/image-20201226191140588.png" alt="image-20201226191140588" data-proofer-ignore></p><h1 id="manual-decoding">Manual Decoding</h1><p>bad_string1</p><h2 id="bad_string1"><span class="mr-2">Bad_String1</span><a href="#bad_string1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>For bad_string1, the value “ynXYUuwtAvWkxfpMbeqGZTrgFNVHmL” is used as a delimiter to create an array, the array is then concatenated back into a string, with a blank value used to join the values.</p><p>Despite the use of arrays and joins, the routine is essentially a search and replace.</p><p><img data-src="/resources/Images/2020-12-27/image-20201226191635426.png" alt="image-20201226191635426" data-proofer-ignore></p><p>Cyberchef can be used to decode the string.</p><p><img data-src="/resources/Images/2020-12-27/image-20201226192121796.png" alt="image-20201226192121796" data-proofer-ignore></p><p>Observing the output, we can see that the code creates some activexobjects for executing shell commands and interacting with the filesystem.</p><p>After this, the code checks if the hardcoded value “qxkFASizeYvpD1TcG” exists as a folder on the system. Not entirely sure what this is, but I think it may act as a basic protection against automated sandbox analysis, since the final payload will not execute if the value is true, and many sandboxes may provide dummy values in order to “satisfy” the code.</p><p>See below that this value is later used to decide whether to execute a string, presumably the final payload.</p><p><img data-src="/resources/Images/2020-12-27/image-20201226195144592.png" alt="image-20201226195144592" data-proofer-ignore></p><h2 id="bad_string2"><span class="mr-2">bad_string2</span><a href="#bad_string2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>bad_string2 only appears once in the initial code, it does not appear to be referenced anywhere else.</p><p>Either it is junk code used to throw off analysis, or the value is used later by code contained in one of the obfuscated strings.</p><p><img data-src="/resources/Images/2020-12-27/image-20201226195808679.png" alt="image-20201226195808679" data-proofer-ignore></p><h2 id="bad_string3"><span class="mr-2">bad_string3</span><a href="#bad_string3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>the bad_string3 decoding routine looks extremely similar to the routine for bad_string1.</p><p><img data-src="/resources/Images/2020-12-27/image-20201226200034294.png" alt="image-20201226200034294" data-proofer-ignore></p><p>Using the same find/replace style approach used in bad_string1, the following payload was retrieved. Interesting, it references values obtained from bad_string1, and appears to use them to decode bad_string2, using a different routine to that used for bad_string1 and 3.</p><p><img data-src="/resources/Images/2020-12-27/image-20201226200854138.png" alt="image-20201226200854138" data-proofer-ignore></p><p>Based on the above, it looks like bad_string2 is an obfuscated registry key. The rest of the code seems to use the previously defined wscript.shell object to check the value of a registry key, and then retrieves the second character of the resulting registry key value.</p><p>The registry key is contained within the bad_string2 variable, so it must be decoded to find out what key is being checked.</p><h3 id="decoding-bad_string2"><span class="mr-2">Decoding bad_string2</span><a href="#decoding-bad_string2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img data-src="/resources/Images/2020-12-27/image-20201226201648767.png" alt="image-20201226201648767" data-proofer-ignore></p><p><img data-src="/resources/Images/2020-12-27/image-20201226202158586.png" alt="image-20201226202158586" data-proofer-ignore></p><p><img data-src="/resources/Images/2020-12-27/image-20201226202343045.png" alt="image-20201226202343045" data-proofer-ignore></p><p>Whats interesting, is that this doen’t even retrieve the “C” value as you might expect, it actually retrieves the “:” colon value.</p><h2 id="bad_string4"><span class="mr-2">bad_string4</span><a href="#bad_string4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img data-src="/resources/Images/2020-12-27/image-20201226202911455.png" alt="image-20201226202911455" data-proofer-ignore></p><p><img data-src="/resources/Images/2020-12-27/image-20201226203226800.png" alt="image-20201226203226800" data-proofer-ignore></p><p>Based on the above notes, there needs to be two rounds of decoding for bad_string4.</p><ul><li>One round where “:” is replaced with “%”.<li>One round where the “kpXvqnzVlFrDNceAHYhufwCxPUsiJo” value is replaced with “e”</ul><p><img data-src="/resources/Images/2020-12-27/image-20201226203421324.png" alt="image-20201226203421324" data-proofer-ignore></p><p>Now note that the end result contains url encoded characters. So these will need to be removed to extract the final payload.</p><p>For readability sake, I’ve copied the output (between the quotes) into a new cyberchef window.</p><p><img data-src="/resources/Images/2020-12-27/image-20201226203734294.png" alt="image-20201226203734294" data-proofer-ignore></p><p>The decoding was successful, and the final payload has now been extracted.</p><h2 id="final-payload-analysis"><span class="mr-2">Final Payload Analysis</span><a href="#final-payload-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The final payload is an executable malware dropper. It utilises:</p><ul><li>shell objects to execute shell commands on the system<li>XMLHTTP Objects for performing HTTP queries<li>ADODB.Stream objects for interacting with the resulting HTTP Streams<li>The “templates” special folder for saving the dropped executable<li>math.random for generating random executable names</ul><p><img data-src="/resources/Images/2020-12-27/image-20201226204429913.png" alt="image-20201226204429913" data-proofer-ignore></p><h1 id="virustotal-analysis-of-domainioc">Virustotal Analysis of Domain/IOC</h1><p>The exact URL has 5/66 detections on virustotal, and was first observed in May 2019.</p><p><img data-src="/resources/Images/2020-12-27/image-20201226204812068.png" alt="image-20201226204812068" data-proofer-ignore></p><p>Interestingly, the domain itself only has 3 detections</p><p><img data-src="/resources/Images/2020-12-27/image-20201226205008133.png" alt="image-20201226205008133" data-proofer-ignore></p><p>There are quite a few subdomains. All resolving to IP’s owned by AliBaba.</p><p><img data-src="/resources/Images/2020-12-27/image-20201226205127622.png" alt="image-20201226205127622" data-proofer-ignore></p><p><img data-src="/resources/Images/2020-12-27/image-20201226205654022.png" alt="image-20201226205654022" data-proofer-ignore></p></div><div class="post-tail-wrapper text-muted"><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Mordor+Ransomware+Dropper+-+Obfuscated+Javascript+with+Hidden+Payloads+-+0xtacolabs&url=https%3A%2F%2F0xtacolabs.github.io%2Fposts%2FMordor-Dropper%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Mordor+Ransomware+Dropper+-+Obfuscated+Javascript+with+Hidden+Payloads+-+0xtacolabs&u=https%3A%2F%2F0xtacolabs.github.io%2Fposts%2FMordor-Dropper%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2F0xtacolabs.github.io%2Fposts%2FMordor-Dropper%2F&text=Mordor+Ransomware+Dropper+-+Obfuscated+Javascript+with+Hidden+Payloads+-+0xtacolabs" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/malware/">malware</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Locky-Ransomware-Dropper/"><div class="card-body"> <em class="small" data-ts="1610409600" data-df="ll" > Jan 12, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Locky Ransomware Dropper - XOR Encoding, Regex, Scheduled Tasks</h3><div class="text-muted small"><p> Javascript-based Locky Ransomware Dropper that utilises Iterative XOR Encoding, Regex, Scheduled Tasks and registry keys. Locky Ransomware Dropper - Iterative XOR encoding, Regex and Scheduled T...</p></div></div></a></div><div class="card"> <a href="/posts/Karbanak-Javascript/"><div class="card-body"> <em class="small" data-ts="1608422400" data-df="ll" > Dec 20, 2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Carbanak Ransomware Dropper - Obfuscated Javascript with Hidden Powershell Payload</h3><div class="text-muted small"><p> Malware dropper that uses obfuscated javascript to execute powershell commands and drop a Carbanak ransomware payload. Carbanak Ransomware Dropper - Javascript with Hidden Powershell Payload Su...</p></div></div></a></div><div class="card"> <a href="/posts/Cerber_Ransomware_Dropper/"><div class="card-body"> <em class="small" data-ts="1605916800" data-df="ll" > Nov 21, 2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Cerber Ransomware Dropper - Custom XOR routine with Regex, XOR and many charcodes</h3><div class="text-muted small"><p> Malware dropper utilising some interesting custom routines for obfuscating a final payload. Regex, XOR and charcodes. Cerber Ransomware Dropper Summary The sample is a well obfuscated javascrip...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Karbanak-Javascript/" class="btn btn-outline-primary" prompt="Older"><p>Carbanak Ransomware Dropper - Obfuscated Javascript with Hidden Powershell Payload</p></a> <a href="/posts/Locky-Ransomware-Dropper/" class="btn btn-outline-primary" prompt="Newer"><p>Locky Ransomware Dropper - XOR Encoding, Regex, Scheduled Tasks</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/0xtacolabs">your_full_name</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/malware/">malware</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
