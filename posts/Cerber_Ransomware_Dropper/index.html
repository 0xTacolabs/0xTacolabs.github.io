<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Cerber Ransomware Dropper - Custom XOR routine with Regex, XOR and many charcodes" /><meta property="og:locale" content="en" /><meta name="description" content="Malware dropper utilising some interesting custom routines for obfuscating a final payload. Regex, XOR and charcodes." /><meta property="og:description" content="Malware dropper utilising some interesting custom routines for obfuscating a final payload. Regex, XOR and charcodes." /><link rel="canonical" href="https://0xtacolabs.github.io/posts/Cerber_Ransomware_Dropper/" /><meta property="og:url" content="https://0xtacolabs.github.io/posts/Cerber_Ransomware_Dropper/" /><meta property="og:site_name" content="0xtacolabs" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-11-21T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Cerber Ransomware Dropper - Custom XOR routine with Regex, XOR and many charcodes" /><meta name="twitter:site" content="@0xtacolabs" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2020-11-21T00:00:00+00:00","datePublished":"2020-11-21T00:00:00+00:00","description":"Malware dropper utilising some interesting custom routines for obfuscating a final payload. Regex, XOR and charcodes.","headline":"Cerber Ransomware Dropper - Custom XOR routine with Regex, XOR and many charcodes","mainEntityOfPage":{"@type":"WebPage","@id":"https://0xtacolabs.github.io/posts/Cerber_Ransomware_Dropper/"},"url":"https://0xtacolabs.github.io/posts/Cerber_Ransomware_Dropper/"}</script><title>Cerber Ransomware Dropper - Custom XOR routine with Regex, XOR and many charcodes | 0xtacolabs</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="0xtacolabs"><meta name="application-name" content="0xtacolabs"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> </a></div><div class="site-title mt-3"> <a href="/">0xtacolabs</a></div><div class="site-subtitle font-italic">A malware analysis blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/0xtacolabs" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/0xtacolabs" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['0xtacolabs','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Cerber Ransomware Dropper - Custom XOR routine with Regex, XOR and many charcodes</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Cerber Ransomware Dropper - Custom XOR routine with Regex, XOR and many charcodes</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1605916800" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Nov 21, 2020 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/0xtacolabs">your_full_name</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1088 words"> <em>6 min</em> read</span></div></div></div><div class="post-content"><p>Malware dropper utilising some interesting custom routines for obfuscating a final payload. Regex, XOR and charcodes.</p><h1 id="cerber-ransomware-dropper">Cerber Ransomware Dropper</h1><h1 id="summary">Summary</h1><p>The sample is a well obfuscated javascript file containing a large and heavily obfuscated string. Analysis of the base code indicates a custom decryption/decoding routine that extracts a primary payload. Once extracted, the code calls out to an attackers server and retrieves a malicious executable binary.</p><p>Analysis of the attackers domain using virustotal indicates that it once hosted cerber ransomware.</p><p>The decryption routine utilises regex to extract hex values from an obfuscated string, which then undergo a interesting brute force and XOR operation to produce a second set of hex values, corresponding to ASCII characters. Once properly extracted, the second set of ascii values make up a payload that retrieves and loads a malicious binary.</p><h2 id="source-file"><span class="mr-2">Source File</span><a href="#source-file" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The sample can be found here, in the HynekPetrak Javascript malware collection.</p><p><img data-src="/resources/Images/2020-11-21/sourcefile.jpg" alt="img" data-proofer-ignore></p><h2 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Analysis of the source file shows that it consists mostly of one large obfuscated string.</p><p>Below that, there are some obfuscated function names, and a reference to a regex query.</p><p><img data-src="/resources/Images/2020-11-21/initial_analysis.jpg" alt="img" data-proofer-ignore></p><p>In order to make any sense of this, I first focused on the large obfuscated block. I removed the joining plus signs and attempted to decode it using any common methods (base64, hex etc), but this was not of any success.</p><p>Then I removed the block, and focused on the surrounding code, in order to get an idea as to how it is used.</p><p><img data-src="/resources/Images/2020-11-21/image45" alt="img" data-proofer-ignore></p><p>This made me realise that the obfuscated block, is actually passed into another function later on in the code. Presumably, this second block where the code is passed, will contain the de-obfuscation routine.</p><p>Adding some newlines for readability, this is where the obfuscated string ends up going. Note that there is an interesting regex function in there.</p><p><img data-src="/resources/Images/2020-11-21/image55" alt="img" data-proofer-ignore></p><p>Rather than reading the obfuscated code, I took a guess at what the variable names might be, and used vscode search/replace to fix them up.</p><p><img data-src="/resources/Images/2020-11-21/image444" alt="img" data-proofer-ignore></p><p>Note that the “getRandomChar()” function, is referencing this code previously defined in the function. Which seems to return a random character from the array in the function.</p><p><img data-src="/resources/Images/2020-11-21/getchar" alt="img" data-proofer-ignore></p><p>At first, I thought these were just a bunch of meaningless characters, but eventually I realised that the possible values contain an XOR operator ^, and all the characters required to spell out “eval”. This will make more sense later.</p><p><img data-src="/resources/Images/2020-11-21/eval" alt="image-20201122174712441" data-proofer-ignore></p><p>On each iteration of the whole while loop, a random set of characters from the “getrandomchar” array will be returned to the “getRandomChar()” function calls.From what I can tell, these are truly random, which means that on most iterations, the function will be invalid. Eg when it becomes “peva(result)” and “p86”. When this happens, the function will gracefully fail, and the error will be caught by the “catch(er)” statement.</p><p>Then, the loop will iterate again and try the next set of random characters. Eventually landing on “^86”(XOR 86) and “eval(result)”. Which will successfully decode the obfuscated string and execute the resulting code.</p><p>Taking into account all of the above, the decryption routine does the following:</p><ul><li>Uses regex to grab substrings of length 7, from our original large obfuscated block.<li>Initiates an array to store the substrings.<li>Uses a while loop to iterate through the substrings and:<ul><li>Extract the last 2 characters of each 7 length substring (if done properly, these will all be valid ascii char codes)<li>Converts the extracted ascii char codes into decimal integers.<li>XOR’s this integer with the decimal 86<li>Converts the XOR’d result into ASCII.<li>Saves the result into a buffer<li>Executes the buffer</ul></ul><h2 id="manual-decryption"><span class="mr-2">Manual Decryption</span><a href="#manual-decryption" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I first copied the large obfuscated string into regex101, in order to test my theory about the 7 char strings and the last two values.</p><p><img data-src="/resources/Images/2020-11-21/regex101" alt="img" data-proofer-ignore></p><p>These were the results, which confirmed the idea that the extracted values could be ascii char codes.</p><p><img data-src="/resources/Images/2020-11-21/regex111" alt="img" data-proofer-ignore></p><p>I then used cyberchef to extract the charcodes, using the same regex as used in regex101.</p><p>Note that I used three recipes,</p><ol><li>To remove whitespace for easier reading<li>To remove the plus signs and create one large string (instead of multiple concatenated strings)<li>Uses regex and find/replace to extract the final charcodes using capture groups.<ol><li>Note the final regex query is (\S{5})(\S{2}), which utilises two capture groups.<li>Were only interested in the second one, hence the $2 in the replace value.</ol></ol><p><img data-src="/resources/Images/2020-11-21/charcodes111" alt="img" data-proofer-ignore></p><p>Alternatively, you could also make it “$2\n” in order to have newline’d output.</p><p><img data-src="/resources/Images/2020-11-21/output1111" alt="img" data-proofer-ignore></p><p>I then tried to XOR this output using cyberchef, but for some reason it didn’t work. It looked like cyber chef was trying to XOR the entire output as one piece, as opposed to XOR’ing each individual charcode.</p><p>So instead, I decided to copy the output into a text file, and use a python script to perform the XOR operation.</p><p><img data-src="/resources/Images/2020-11-21/output_text_file.jpg" alt="img" data-proofer-ignore></p><p>I was able to devise the following python script.</p><p><img data-src="/resources/Images/2020-11-21/python_script_decoce" alt="img" data-proofer-ignore></p><p>Which when executed, produced the following output. If you look closely, this looks like valid javascript code (success!).</p><p><img data-src="/resources/Images/2020-11-21/decoded1011" alt="img" data-proofer-ignore></p><p>So I copied and pasted the above output into cyberchef for round 2.</p><h3 id="second-round-of-de-obfuscation"><span class="mr-2">Second Round of De-obfuscation</span><a href="#second-round-of-de-obfuscation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>I copied the output into cyberchef, and then used the “generic code beautify” and “syntax highlighter” functions to make the code more readable.</p><p>Most of the code looks fairly standard, MSXML objects for url retrieval, and activexobjects for code execution and access to deeper (than standard javascript) functionality.</p><p>If you look at the highlighted boxes, you can even see the attackers servers and extract them as IOC’s</p><p><img data-src="/resources/Images/2020-11-21/second_round" alt="img" data-proofer-ignore></p><p>Based on the above and below, we can tell that the file’s primary function is to retrieve a malicious executable file.</p><p>We can also see the use of the math.random function for naming the file, so it won’t have a predictable filename that can be used as an IOC. We can also see that it intends on saving the file to the windows temp folder.</p><p><img data-src="/resources/Images/2020-11-21/dropper" alt="img" data-proofer-ignore></p><p>Eventually, we get to the end of the code, where we can see the use of wscript to access windows shell functionality, and utilise cmd.exe to execute the dropped payload. Interestingly, it also tries to delete the source .js file, as well as any other js files in the directory.</p><p><img data-src="/resources/Images/2020-11-21/endcode.jph" alt="img" data-proofer-ignore></p><h3 id="analysis-of-ioc-domains"><span class="mr-2">Analysis of IOC Domains</span><a href="#analysis-of-ioc-domains" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Interestingly, the domains don’t have that many detections on virustotal.</p><p><img data-src="/resources/Images/2020-11-21/bad-domain" alt="img" data-proofer-ignore></p><p><img data-src="/resources/Images/2020-11-21/file2132132" alt="img" data-proofer-ignore></p><h3 id="python-script"><span class="mr-2">Python Script</span><a href="#python-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Here’s a copy python script I made for extracting the second payload.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s">"r"</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">readlines</span><span class="p">()</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">86</span>        

        
        <span class="k">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">end</span><span class="o">=</span><span class="s">""</span><span class="p">)</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Cerber+Ransomware+Dropper+-+Custom+XOR+routine+with+Regex%2C+XOR+and+many+charcodes+-+0xtacolabs&url=https%3A%2F%2F0xtacolabs.github.io%2Fposts%2FCerber_Ransomware_Dropper%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Cerber+Ransomware+Dropper+-+Custom+XOR+routine+with+Regex%2C+XOR+and+many+charcodes+-+0xtacolabs&u=https%3A%2F%2F0xtacolabs.github.io%2Fposts%2FCerber_Ransomware_Dropper%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2F0xtacolabs.github.io%2Fposts%2FCerber_Ransomware_Dropper%2F&text=Cerber+Ransomware+Dropper+-+Custom+XOR+routine+with+Regex%2C+XOR+and+many+charcodes+-+0xtacolabs" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/malware/">malware</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Locky-Ransomware-Dropper/"><div class="card-body"> <em class="small" data-ts="1610409600" data-df="ll" > Jan 12, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Locky Ransomware Dropper - XOR Encoding, Regex, Scheduled Tasks</h3><div class="text-muted small"><p> Javascript-based Locky Ransomware Dropper that utilises Iterative XOR Encoding, Regex, Scheduled Tasks and registry keys. Locky Ransomware Dropper - Iterative XOR encoding, Regex and Scheduled T...</p></div></div></a></div><div class="card"> <a href="/posts/Mordor-Dropper/"><div class="card-body"> <em class="small" data-ts="1609027200" data-df="ll" > Dec 27, 2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Mordor Ransomware Dropper - Obfuscated Javascript with Hidden Payloads</h3><div class="text-muted small"><p> Javascript Malware Dropper that retrieves and executes a Mordor Ransomware payload. Utilises a few basic anti-automation techniques. Mordor Ransomware Dropper with Multiple Layers on Encoding S...</p></div></div></a></div><div class="card"> <a href="/posts/Karbanak-Javascript/"><div class="card-body"> <em class="small" data-ts="1608422400" data-df="ll" > Dec 20, 2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Carbanak Ransomware Dropper - Obfuscated Javascript with Hidden Powershell Payload</h3><div class="text-muted small"><p> Malware dropper that uses obfuscated javascript to execute powershell commands and drop a Carbanak ransomware payload. Carbanak Ransomware Dropper - Javascript with Hidden Powershell Payload Su...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/TeslaCrypt-Malware-Dropper/" class="btn btn-outline-primary" prompt="Older"><p>Teslacrypt Malware Dropper with IOC Extraction</p></a> <a href="/posts/Karbanak-Javascript/" class="btn btn-outline-primary" prompt="Newer"><p>Carbanak Ransomware Dropper - Obfuscated Javascript with Hidden Powershell Payload</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/0xtacolabs">your_full_name</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/malware/">malware</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
